# ğŸš€ MongoDB & Mongo Express Deployment on Kubernetes (AWS)

![Kubernetes](https://img.shields.io/badge/kubernetes-%23326ce5.svg?style=for-the-badge&logo=kubernetes&logoColor=white)
![AWS](https://img.shields.io/badge/AWS-%23FF9900.svg?style=for-the-badge&logo=amazon-aws&logoColor=white)
![MongoDB](https://img.shields.io/badge/MongoDB-%234ea94b.svg?style=for-the-badge&logo=mongodb&logoColor=white)
![Docker](https://img.shields.io/badge/docker-%230db7ed.svg?style=for-the-badge&logo=docker&logoColor=white)
![License](https://img.shields.io/badge/license-MIT-blue.svg?style=for-the-badge)

## ğŸ“Œ Project Overview
This project demonstrates a **production-ready deployment** of MongoDB on a Kubernetes cluster (kubeadm) running on AWS EC2. It showcases the integration of **Amazon EBS CSI Driver** for dynamic persistent storage and provides a web-based management interface via **Mongo Express**, securely exposed through an AWS LoadBalancer.

> **Objective:** To implement a secure, scalable, and persistent stateful workload on Kubernetes using cloud-native storage solutions.

---


## ğŸ—ï¸ Architecture Overview
The system design ensures high availability and data durability by decoupling the database engine from the underlying storage.

### ğŸ›ï¸ System Architecture Diagram
To better understand the infrastructure design, please refer to the high-resolution architecture blueprint located in the repository:

### ğŸ–¼ï¸ **[architecture/](./architecture/)**



> **Infrastructure Blueprint:** This diagram illustrates the relationship between the Kubernetes workloads (Deployments & Services) and the AWS Cloud resources (EBS Volumes & IAM Policies), providing a comprehensive overview of the system's design.

### **ğŸš¦ Traffic & Data Flow:**
1. ğŸŒ **Public Access:** Users access **Mongo Express** via HTTP on port `8081` through an **AWS LoadBalancer**.
2. ğŸ”„ **Internal Communication:** Mongo Express connects to the **MongoDB Service** (ClusterIP) within the cluster.
3. ğŸ’¾ **Persistence:** The MongoDB Pod mounts a **Persistent Volume (PV)** backed by **Amazon EBS**, managed dynamically by the **CSI Driver**.

---


## âœ¨ Key Features
| Feature | Implementation Details |
| :--- | :--- |
| **Data Persistence** | **Amazon EBS (RWO)** ensures data survives Pod restarts or failures. |
| **Storage Management** | **Dynamic Provisioning** using a custom StorageClass (`ebs.csi.aws.com`). |
| **Security** | **K8s Secrets** for credentials and **ConfigMaps** for environment-specific settings. |
| **Administration** | **Mongo Express UI** for easy browser-based database management. |
| **Scalability** | Designed as a **Deployment** to leverage K8s orchestration and recovery. |

---


## ğŸ“¸ Implementation Documentation (Step-by-Step)
This repository provides a comprehensive visual walkthrough of the entire deployment lifecycle. Detailed proof of implementationâ€”from infrastructure provisioning to final application verificationâ€”is documented within the dedicated directory below:

### ğŸ“‚ **[screenshots](./screenshots/)**

> This gallery serves as a step-by-step technical guide, showcasing the successful execution of all Kubernetes manifests and the seamless integration of AWS cloud-native resources.

---


## ğŸ§° Technologies & Tools
* **Orchestration:** Kubernetes (kubeadm)
* **Cloud Infrastructure:** AWS (EC2, IAM, EBS)
* **Database:** MongoDB
* **UI Management:** Mongo Express
* **Storage Integration:** AWS EBS CSI Driver
* **Automation:** YAML Manifests

---


## ğŸš€ How to Deploy

1.  **Clone the Repository:**
    ```bash
    git clone [https://github.com/MOHANAD987/mongodb-project.git](https://github.com/MOHANAD987/mongodb-project.git)
    cd mongodb-project
    ```

2.  **Apply Storage & Security Manifests:**
    ```bash
    kubectl apply -f mongodb-sc.yaml
    kubectl apply -f mongodb-secret.yaml
    kubectl apply -f mongodb-cm.yaml
    kubectl apply -f mongodb-pvc.yaml
    ```

3.  **Deploy the Application:**
    ```bash
    kubectl apply -f mongodb-app.yaml
    kubectl apply -f mongo-express-app.yaml
    kubectl apply -f mongo-express-svc.yaml
    ```

4.  **Access the Dashboard:**
    * Retrieve the LoadBalancer URL: `kubectl get svc mongo-express-svc`
    * Open `http://<EXTERNAL-IP>:8081` in your browser.

---


## ğŸ“‚ Repository Structure

```text

mongodb-project/
â”œâ”€â”€ architecture/            # ğŸ“ Reference Architecture Diagram
â”œâ”€â”€ screenshots/             # ğŸ“¸ Step-by-step Execution Screenshots
â”œâ”€â”€ mongodb-secret.yaml      # ğŸ” Encrypted Credentials
â”œâ”€â”€ mongodb-sc.yaml          # ğŸ’¾ StorageClass (ebs.csi.aws.com)
â”œâ”€â”€ mongodb-pvc.yaml         # ğŸ“‚ PersistentVolumeClaim
â”œâ”€â”€ mongodb-app.yaml         # ğŸš€ MongoDB Deployment
â”œâ”€â”€ mongodb-svc.yaml         # ğŸ”Œ Internal ClusterIP Service
â”œâ”€â”€ mongodb-cm.yaml          # âš™ï¸ App Configurations
â”œâ”€â”€ mongo-express-app.yaml   # ğŸ–¥ï¸ Admin UI Deployment
â”œâ”€â”€ mongo-express-svc.yaml   # ğŸŒ External LoadBalancer Service
â”œâ”€â”€ LICENSE                  # âš–ï¸ MIT License
â””â”€â”€ README.md                # ğŸ“– Project Documentation

---


##âš–ï¸ License
This project is licensed under the MIT License. See the LICENSE file for details.


---


##ğŸ‘¨â€ğŸ’» Author
Mohanad Faisal
DevOps Engineer | Cloud & Kubernetes Enthusiast

---
















# ğŸš€ NodeJS Application Monitoring on Kubernetes  
### **Enterprise-Grade Observability: Prometheus â€¢ Grafana â€¢ Alertmanager â€¢ Slack**

<table>
  <tr>
    <td><img src="https://raw.githubusercontent.com/devicons/devicon/master/icons/kubernetes/kubernetes-plain.svg" width="35" height="35"></td>
    <td><img src="https://raw.githubusercontent.com/devicons/devicon/master/icons/prometheus/prometheus-original.svg" width="35" height="35"></td>
    <td><img src="https://raw.githubusercontent.com/devicons/devicon/master/icons/grafana/grafana-original.svg" width="35" height="35"></td>
    <td><img src="https://raw.githubusercontent.com/devicons/devicon/master/icons/docker/docker-original.svg" width="35" height="35"></td>
    <td><img src="https://raw.githubusercontent.com/devicons/devicon/master/icons/nodejs/nodejs-original.svg" width="35" height="35"></td>
    <td><img src="https://raw.githubusercontent.com/devicons/devicon/master/icons/slack/slack-original.svg" width="35" height="35"></td>
  </tr>
  <tr>
    <td><b>K8s</b></td>
    <td><b>Prometheus</b></td>
    <td><b>Grafana</b></td>
    <td><b>Docker</b></td>
    <td><b>NodeJS</b></td>
    <td><b>Slack</b></td>
  </tr>
</table>

---
---






# ğŸš€ NodeJS Application Monitoring on Kubernetes  
### **Enterprise-Grade Observability: Prometheus â€¢ Grafana â€¢ Alertmanager â€¢ Slack**

<p align="center">
  <img src="https://img.shields.io/badge/Kubernetes-v1.30-326ce5?style=for-the-badge&logo=kubernetes&logoColor=white" />
  <img src="https://img.shields.io/badge/Prometheus-Monitoring-e6522c?style=for-the-badge&logo=prometheus&logoColor=white" />
  <img src="https://img.shields.io/badge/Grafana-Dashboards-f46800?style=for-the-badge&logo=grafana&logoColor=white" />
  <img src="https://img.shields.io/badge/Docker-Containerization-2496ed?style=for-the-badge&logo=docker&logoColor=white" />
  <img src="https://img.shields.io/badge/Node.js-Application-339933?style=for-the-badge&logo=node.js&logoColor=white" />
  <img src="https://img.shields.io/badge/Slack-Alerting-4A154B?style=for-the-badge&logo=slack&logoColor=white" />
</p>

---

## ğŸ“‹ Table of Contents
- [ğŸ“Œ Project Overview](#-project-overview)
- [ğŸ—ï¸ System Architecture](#ï¸-system-architecture)
- [ğŸ› ï¸ Technologies Used](#ï¸-technologies-used)
- [ğŸ“‚ Project Structure](#-project-structure)
- [ğŸš€ Deployment Guide](#-deployment-guide)
- [ğŸ“Š Metrics & Alerting](#-metrics--alerting)
- [ğŸ¯ Why This Project?](#-why-this-project)

---

## ğŸ“Œ Project Overview

This project is a **production-oriented DevOps capstone** designed to bridge the gap between application development and infrastructure reliability. It demonstrates a complete end-to-end lifecycle of a containerized application with a heavy focus on **Observability (SRE Principles)**.

**Key Highlights:**
- âœ… **Dynamic Scaling:** Application deployed on a multi-node K8s cluster.
- âœ… **Custom Instrumentation:** Using `prom-client` to expose business-specific metrics.
- âœ… **Proactive Monitoring:** Real-time data visualization and anomaly detection.
- âœ… **Automated Incident Response:** Instant Slack notifications for threshold breaches.

---

## ğŸ—ï¸ System Architecture



### ğŸ”„ The Observability Flow
1. **App Level:** Node.js app generates metrics on `/metrics`.
2. **Cluster Level:** Prometheus discovery finds targets and scrapes data.
3. **Visualization:** Grafana queries Prometheus to build heatmaps and graphs.
4. **Alerting:** Prometheus evaluates rules â†’ Sends to Alertmanager â†’ Delivers to Slack.

---

## ğŸ› ï¸ Technologies Used

| Category | Tool | Purpose |
| :--- | :--- | :--- |
| **Orchestration** | `Kubernetes` | Container Management & Scheduling |
| **Containerization** | `Docker` | Image Creation & Distribution |
| **Backend** | `Node.js` | Express API with Prometheus Client |
| **Metrics Engine** | `Prometheus` | Time-series data collection |
| **Visualization** | `Grafana` | Professional Monitoring Dashboards |
| **Incident Management** | `Alertmanager` | Alert Routing & Deduplication |
| **Communication** | `Slack` | Real-time Alert Notifications |

---

## ğŸ“‚ Project Structure

```bash
nodejs-k8s-monitoring/
â”œâ”€â”€ ğŸ“ app/                      # Source Code & Containerization
â”‚   â”œâ”€â”€ index.js                 # App with /metrics endpoint
â”‚   â””â”€â”€ Dockerfile               # Optimized multi-stage build
â”œâ”€â”€ ğŸ“ k8s/                      # Infrastructure as Code (YAML)
â”‚   â”œâ”€â”€ ğŸ“ app/                  # Deployment & Service manifests
â”‚   â””â”€â”€ ğŸ“ monitoring/           # ServiceMonitor & Alerting Rules
â”œâ”€â”€ ğŸ“ scripts/                  # Automation & DevOps Tools
â”‚   â”œâ”€â”€ send_requests.sh         # Traffic simulation script
â”‚   â””â”€â”€ ğŸ“ kubeadm/              # Cluster bootstrap scripts
â””â”€â”€ ğŸ“ architecture/             # Design diagrams & Screenshots


---

ğŸš€ Deployment Guide
1ï¸âƒ£ Bootstrap Kubernetes Cluster
Run these on your nodes to initialize the environment using kubeadm:

# On Master & Worker Nodes respectively
```bash
./scripts/kubeadm/01-install-k8s-master.sh
./scripts/kubeadm/02-install-k8s-node1.sh
```


2ï¸âƒ£ Ship the Application
Build your image and push it to the registry:

Bash
```bash
docker build -t <username>/nodejs-app:v1 ./app
docker push <username>/nodejs-app:v1
```
3ï¸âƒ£ Orchestrate with Kubernetes
Bash

# Deploy App & Monitoring Stack
kubectl apply -f k8s/app/
kubectl apply -f k8s/monitoring/
ğŸ“Š Metrics & Alerting
ğŸ“ˆ Metrics Exposed
Business: http_requests_root_total (Track user traffic).

Runtime: Heap usage, Event loop lag, Garbage collection.

Infra: CPU/Memory usage per Pod, Node Disk I/O.

ğŸ”” Smart Alerting
We don't just monitor; we notify. When traffic exceeds 10 req/sec, an alert is fired:

YAML

alert: HighRequestRate_NodeJS
expr: rate(http_requests_root_total[5m]) > 10
for: 1m
labels:
  severity: critical
ğŸ¯ Why This Project Matters
Production Ready: Uses secrets for sensitive Slack Webhooks.

Scalable: Designed to handle multiple microservices.

SRE Focused: Implements the "Four Golden Signals" of monitoring.

ğŸ‘¨â€ğŸ’» Author
Mohanad Faisal DevOps Engineer

















# ğŸš€ NodeJS Application Monitoring on Kubernetes  
**Prometheus â€¢ Grafana â€¢ Alertmanager â€¢ Slack**

![Kubernetes](https://img.shields.io/badge/Kubernetes-v1.30-326ce5?logo=kubernetes&logoColor=white)
![Prometheus](https://img.shields.io/badge/Prometheus-Monitoring-e6522c?logo=prometheus&logoColor=white)
![Grafana](https://img.shields.io/badge/Grafana-Dashboards-f46800?logo=grafana&logoColor=white)
![Docker](https://img.shields.io/badge/Docker-Containerization-2496ed?logo=docker&logoColor=white)
![Node.js](https://img.shields.io/badge/Node.js-Application-339933?logo=node.js&logoColor=white)



## ğŸ“Œ Project Overview

This project is a **production-oriented DevOps capstone** that demonstrates how to:

- Deploy a **NodeJS application** on Kubernetes.
- Expose **custom application metrics** using Prometheus client.
- Collect **cluster & application metrics** via Prometheus.
- Visualize metrics using **Grafana dashboards**.
- Configure **Alertmanager** to send alerts to **Slack**.
- Automate Kubernetes cluster setup using **kubeadm scripts**.

The project follows **real-world monitoring and observability best practices** used in production environments.


---


## ğŸ—ï¸ System Architecture

### High-Level Architecture

![System Architecture](architecture/system-architecture.png)

### Monitoring & Alerting Flow

![Monitoring Flow](architecture/monitoring-flow.png)  
![Alerting Flow](architecture/alerting-flow.png)


---


## ğŸ› ï¸ Technologies Used

| Component | Technology |
|---------|------------|
| Containerization | Docker |
| Orchestration | Kubernetes (kubeadm) |
| Application | NodeJS (Express) |
| Metrics | Prometheus |
| Visualization | Grafana |
| Alerting | Alertmanager |
| Notifications | Slack Webhook |
| OS | Ubuntu Linux |


---


## ğŸ“‚ Project Structure

```text
nodejs-k8s-monitoring/
â”‚
â”œâ”€â”€ app/                          # NodeJS application
â”‚   â”œâ”€â”€ index.js
â”‚   â””â”€â”€ Dockerfile
â”‚
â”œâ”€â”€ k8s/                          # Kubernetes manifests
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ nodejs-app.yaml
â”‚   â”‚   â””â”€â”€ nodejs-svc.yaml
â”‚   â”‚
â”‚   â””â”€â”€ monitoring/
â”‚       â”œâ”€â”€ nodejs-monitor-svc.yaml
â”‚       â”œâ”€â”€ nodejs-rule.yaml
â”‚       â”œâ”€â”€ nodejs-alert-manager.yaml
â”‚       â””â”€â”€ slack-secret-example.yaml
|       |__ .gitignoreâ”‚
|
â”œâ”€â”€ scripts/                      # Automation scripts
â”‚   â”œâ”€â”€ send_requests.sh
â”‚   â””â”€â”€ kubeadm/
â”‚       â”œâ”€â”€ 01-install-k8s-master.sh
â”‚       â”œâ”€â”€ 02-install-k8s-node1.sh
â”‚       â””â”€â”€ 03-install-k8s-node2.sh
â”‚
â”œâ”€â”€ screenshots/                  # Execution proof
â”‚   
â”‚   
â”‚  
â”‚
â”œâ”€â”€ architecture/                 # Architecture diagrams
â”‚   
â”‚   
â”‚
â””â”€â”€ README.md
```


---


ğŸš€ Deployment Guide
1ï¸âƒ£ Kubernetes Cluster Setup (kubeadm)

Run the following scripts on each node:

```bash
scripts/kubeadm/01-install-k8s-master.sh
scripts/kubeadm/02-install-k8s-node1.sh
scripts/kubeadm/03-install-k8s-node2.sh
```


2ï¸âƒ£ Build & Push NodeJS Image

```bash
docker build -t <dockerhub-username>/nodejs-app:v1 .
docker push <dockerhub-username>/nodejs-app:v1
```


3ï¸âƒ£ Deploy NodeJS Application

```bash
kubectl apply -f k8s/app/nodejs-app.yaml
kubectl apply -f k8s/app/nodejs-svc.yaml
```


4ï¸âƒ£ Deploy Monitoring Stack

```bash
kubectl apply -f k8s/monitoring/
```


5ï¸âƒ£ Grafana Dashboards

-Connect Grafana to Prometheus datasource.

-Import dashboards for:

*Node metrics

*Pod CPU / Memory

*Application metrics



6ï¸âƒ£ Alert Testing & Slack Notifications

Generate traffic using:

```bash
scripts/send_requests.sh
```




---



ğŸ“Š Metrics Exposed

-Application Metrics:

http_requests_root_total

Default NodeJS process metrics



-Kubernetes Metrics:

Pod CPU & Memory

Container restarts

Node resource usage



---


ğŸ”” Alerting Rules

Example alert:

```bash
alert: HighRequestRate_NodeJS
expr: rate(http_requests_root_total[5m]) > 10
```
Triggers Slack notification when request rate exceeds threshold.



---



ğŸ¯ Why This Project Matters

This project demonstrates:

âœ” Real-world Kubernetes monitoring
âœ” Application instrumentation best practices
âœ” Alerting & incident awareness
âœ” Production-ready DevOps mindset
âœ” Clean architecture & documentation


---





ğŸš€ Future Enhancements

-Add Helm charts

-Enable HPA based on custom metrics

-Add TLS & Ingress

-Centralized logging with Loki


---





ğŸ‘¨â€ğŸ’» Author

Mohanad Faisal
DevOps Engineer
